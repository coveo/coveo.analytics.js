<html>
<script>
(function(c,o,v,e,O,u,a){
a='coveoua';c[a]=c[a]||function(){(c[a].q=c[a].q|| []).push(arguments)};
c[a].t=Date.now();u=o.createElement(v);u.async=1;u.src=e;
O=o.getElementsByTagName(v)[0];O.parentNode.insertBefore(u,O)
})(window,document,'script','coveoua.js')

// Replace YOUR-TOKEN with your real token
// (eg: an API key which has the rights to write into Coveo UsageAnalytics)
coveoua('init','YOUR-TOKEN');
coveoua('ec:addProduct', {name: "wow", id: 'something', brand: 'brand', custom: { "verycustom": "value" }, unknown: "shouldberemoved"});
coveoua('ec:setAction', 'detail', {storeid: "amazing"});
coveoua('send', "pageview", "/firstpage");

setTimeout(function() {
    coveoua('ec:setAction', 'purchase', {storeid: "amazing"});
    coveoua('send', "event", "eventCategory", "eventAction", "eventLabel", "eventValue");
    coveoua('send', "pageview", "/secondpage");
    coveoua('send', "event");
}, 1000);

function testBeacon() {
    coveoua('ec:addProduct', {name: "wow", id: 'something', brand: 'brand', custom: { "verycustom": "value" }, unknown: "shouldberemoved"});
    coveoua('ec:setAction', 'addToCart');
    coveoua('send', 'event')
    window.location = "index.html?added=" + new Date().valueOf();
}
</script>

<body>
    <button onclick="testBeacon()">Test beacon</button>
</body>
</html>